<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <meta name="theme-color" content="#ffffff"/>
  <title>Boda de Abril & Pablo üíç</title>

  <!-- Fuentes -->
  <link href="https://fonts.cdnfonts.com/css/waltograph" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400;1,700&family=Quicksand:wght@300;400;700&display=swap" rel="stylesheet"/>

  <style>
    :root{
      --bg-cream:#f8f5f0;
      --deep:#2b2a2f;
      --glass:rgba(255,255,255,.88);
      --glass-strong:rgba(255,255,255,.96);
      --rose:#cfae7c; /* oro rosado suave */
      --accent:#66c9ff; /* celeste */
      --accent2:#4a8fe7;
      --wa:#25D366;
      --shadow:0 20px 60px rgba(0,0,0,.14);
      --ease:cubic-bezier(.2,.9,.2,1);

      /* tarjetas celeste empolvado + borde dorado fino */
      --card-bg: linear-gradient(180deg,#e0f2ff 0%, #ffffff 60%);
      --card-border: 1.2px solid #cfae7c;

      /* botones itinerario opci√≥n B + borde dorado */
      --btn-bg: linear-gradient(135deg,#eaf6ff,#ffffff);
      --btn-border: 1.2px solid #cfae7c;
      --btn-shadow: 0 10px 28px rgba(0,0,0,.10);

      /* men√∫ */
      --menu-bg: rgba(255,255,255,.94);
      --menu-shadow: 0 16px 38px rgba(0,0,0,.16);

      /* m√∫sica flotante */
      --music-grad: linear-gradient(135deg, #ffffff 0%, #9fd7ff 28%, #cfcfcf 64%, #a7ffcf 100%);
    }

    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg-cream);color:var(--deep);font-family:Quicksand,system-ui,Arial;-webkit-font-smoothing:antialiased}
    img{max-width:100%;height:auto;display:block}
    a{text-decoration:none;color:inherit}
    button{font-family:inherit;cursor:pointer}

    /* Vista tipo libro (vertical) */
    .viewport{height:100svh;overflow:hidden;position:relative}
    .sections{height:100%;width:100%;position:relative;perspective:1200px}
    .section{
      position:absolute; inset:0;
      display:flex; align-items:center; justify-content:center;
      padding:18px;
      background-size:cover; background-position:center;
      opacity:0; transform:rotateY(90deg) translateZ(-200px);
      transition:transform .9s var(--ease), opacity .6s ease; backface-visibility:hidden;
    }
    .section.active{opacity:1; transform:rotateY(0) translateZ(0)}
    .section.prev  {opacity:0; transform:rotateY(-90deg) translateZ(-200px)}
    .section.next  {opacity:0; transform:rotateY( 90deg) translateZ(-200px)}
    .overlay{position:absolute; inset:0; background:linear-gradient(180deg,rgba(255,255,255,.18),rgba(255,255,255,.48)); pointer-events:none}

    /* Fondos */
    .bg-portada{background-image:url('fondo_floral.jpg')}
    .bg-p1{background-image:url('fondo_floral1.png')}
    .bg-p2{background-image:url('fondo_floral2.jpg')}
    .bg-p3{background-image:url('fondo_floral3.jpg')}
    .bg-p4{background-image:url('fondo_floral4.png')}
    .bg-p5{background-image:url('fondo_floral5.jpg')}
    .bg-p6{background-image:url('fondo_floral6.jpg')}
    .bg-p7{background-image:url('fondo_floral7.jpg')}
    .bg-p8{background-image:url('fondo_floral9.jpg')}
    .bg-p9{background-image:url('fondo_floral8.png')}

    /* Tarjeta central (80‚Äì92% alto seg√∫n dispositivo) */
    .card{
      position:relative; z-index:2;
      width:min(980px, 92vw);
      min-height: clamp(68vh, 80vh, 92vh);
      background:var(--card-bg); border:var(--card-border);
      border-radius:18px; padding:22px; box-shadow:var(--shadow);
      display:flex; flex-direction:column; align-items:center; justify-content:center;
    }

    /* Tipograf√≠a */
    h1,h2,h3,h4{font-family:'Playfair Display',serif;margin:0 0 8px}
    .title-top{font-size: clamp(34px, 6.5vw, 52px); letter-spacing:.5px; text-align:center}
    .title-acepto{
      font-family:'Waltograph',cursive;
      font-size: clamp(28px, 6.2vw, 46px);
      margin-top:6px; text-align:center;
      background:linear-gradient(135deg,#fff,#ffe7b3 40%,#e3c792 62%,#fff);
      -webkit-background-clip:text; background-clip:text; color:transparent;
      text-shadow:0 0 22px rgba(227,199,146,.55), 0 0 8px rgba(255,255,255,.65);
      filter: drop-shadow(0 4px 14px rgba(0,0,0,.12));
    }
    .romantic{font-family:'Playfair Display',serif}
    .verse{font-family:'Playfair Display',serif; font-style:italic; font-size:clamp(14px,3.8vw,18px); text-align:center; color:#6c5a46}
    .note{color:#555; font-size:14px}

    /* Portada: anillo + botones */
    .btns{margin-top:14px; display:flex; gap:10px; justify-content:center; flex-wrap:wrap}
    .magicBtn{
      padding:10px 14px; border-radius:12px; border:var(--btn-border);
      background:var(--btn-bg); color:#163a5a; font-weight:800;
      box-shadow:var(--btn-shadow);
    }
    .magicBtn:hover{filter:brightness(1.04)}

    /* Anillos (portada y overlay de entrada) */
    .ring-button,.entry-ring{background:transparent; border:0; padding:0; cursor:pointer; display:block; margin:12px auto; position:relative}
    .ring-svg{width:220px; height:220px; display:block}
    .ring-rotate{animation:ringSpin 14s linear infinite; transform-origin:110px 110px}
    @keyframes ringSpin{to{transform:rotate(360deg)}}
    .ring-spark{position:absolute; left:50%; top:35%; width:140px; height:140px; transform:translate(-50%,-50%); pointer-events:none; border-radius:50%; opacity:0}
    .ring-button.clicked .ring-spark{animation:spark 900ms ease-out forwards}
    @keyframes spark{0%{opacity:0; transform:translate(-50%,-50%) scale(.6)} 30%{opacity:1; transform:translate(-50%,-50%) scale(1.05)} 100%{opacity:0; transform:translate(-50%,-50%) scale(1.6)}}
    .ring-instruction,.entry-instruction{font-size:13px;color:#333;margin-top:6px;text-align:center}

    /* Contadores (mini portada + grande itinerario) */
    .mini-flip{display:flex; gap:8px; justify-content:center; margin-top:8px; align-items:center}
    .flip-mini{width:66px; height:66px; perspective:800px; position:relative}
    .flip-mini .face{
      position:absolute; left:0; top:0; width:100%; height:50%;
      overflow:hidden; border-radius:12px; background:var(--glass-strong);
      display:flex; align-items:center; justify-content:center;
      font-weight:800; font-size:20px; font-family:'Playfair Display',serif;
      box-shadow:0 8px 22px rgba(0,0,0,.08);
    }
    .flip-mini .top{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:bottom}
    .flip-mini .bottom{top:50%;border-top-left-radius:0;border-top-right-radius:0;transform-origin:top}
    .flip-mini.animate .top{animation:flipTop .7s forwards}
    .flip-mini.animate .bottom{animation:flipBottom .7s forwards}

    .flip-grid{display:flex; gap:10px; justify-content:center; align-items:center; margin-top:12px; flex-wrap:wrap}
    .flip{width:86px; height:80px; perspective:900px; position:relative}
    .flip .panel{
      position:absolute; left:0; top:0; width:100%; height:100%; border-radius:12px;
      background:var(--glass-strong); display:flex; align-items:center; justify-content:center;
      font-family:'Playfair Display',serif; font-size:24px; box-shadow:0 10px 30px rgba(0,0,0,.08);
    }
    .flip .top{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:bottom;z-index:2}
    .flip .bottom{top:50%;border-top-left-radius:0;border-top-right-radius:0;transform-origin:top;z-index:1}
    .flip.animate .top{animation:flipTop .7s forwards}
    .flip.animate .bottom{animation:flipBottom .7s forwards}
    .flip .label{font-size:12px; color:#333; margin-top:8px; text-align:center}
    @keyframes flipTop{0%{transform:rotateX(0)}100%{transform:rotateX(-180deg)}}
    @keyframes flipBottom{0%{transform:rotateX(180deg)}100%{transform:rotateX(0)}}

    /* Padres (bloques amplios, vertical) */
    .parents-wrap{width:100%; display:flex; flex-direction:column; gap:16px; margin-top:12px}
    .parent-block{
      width:100%; max-width:780px; margin:0 auto;
      background:var(--glass-strong); border:var(--card-border); border-radius:14px;
      padding:14px 16px; text-align:center;
      box-shadow:0 12px 26px rgba(0,0,0,.08);
    }
    .parent-title{font-weight:800; font-size:18px; color:#334}
    .parent-names{font-family:'Playfair Display',serif; font-size:clamp(18px,4.6vw,22px); line-height:1.35}

    .honor-phrase{
      margin:10px auto 0; max-width:820px; text-align:center;
      font-family:'Playfair Display',serif; font-size:clamp(16px,4.6vw,20px);
      color:#5b4734; letter-spacing:.2px;
    }
    .couple-big{
      margin-top:12px; text-align:center;
      font-family:'Playfair Display',serif; font-size:clamp(22px,6.4vw,34px);
      background:linear-gradient(135deg,#1c3144,#6d7a8a); -webkit-background-clip:text; color:transparent;
      text-shadow:0 1px 0 #fff6;
    }

    /* Galer√≠a */
    .gallery-grid{display:flex; gap:12px; flex-wrap:wrap; justify-content:center; margin-top:12px}
    .gallery-grid img{
      width:min(260px, 44vw); height:min(176px, 32vw); object-fit:cover; border-radius:12px;
      box-shadow:0 10px 30px rgba(0,0,0,.12); cursor:pointer; transition:transform .35s, opacity .35s;
    }
    .gallery-grid img:hover{transform:scale(1.03); opacity:.96}

    /* Itinerario (tarjetas amplias + botones con borde dorado) */
    .itinerary{display:flex; flex-direction:column; gap:14px; margin-top:10px; width:100%; max-width:880px}
    .it-item{
      display:flex; gap:14px; align-items:flex-start; padding:16px; border-radius:14px;
      background:var(--glass-strong); border:var(--card-border); box-shadow:0 12px 26px rgba(0,0,0,.10);
    }
    .it-icon{min-width:56px; height:56px; border-radius:12px; border:var(--btn-border); background:#fff; display:flex; align-items:center; justify-content:center; font-size:24px; box-shadow:var(--btn-shadow)}
    .it-info strong{display:block; font-family:'Playfair Display',serif; font-size:18px}
    .map-row{margin-top:8px; display:flex; flex-wrap:wrap; gap:10px}
    .map-link{
      display:inline-flex; align-items:center; gap:8px;
      padding:10px 12px; border-radius:12px; border:var(--btn-border);
      background:var(--btn-bg); color:#163a5a; font-weight:800; box-shadow:var(--btn-shadow)
    }

    .palette{display:flex; gap:8px; margin-top:8px}
    .chip{width:22px; height:22px; border-radius:6px}
    .chip.c1{background:#a8dadc} .chip.c2{background:#efe5d0} .chip.c3{background:#a8e6cf} .chip.c4{background:#c5ced6} .chip.c5{background:#f7b6b1}

    /* RSVP y Deseos (tarjetas y carrusel) */
    .form-wrap{width:100%; max-width:780px; display:grid; gap:12px; grid-template-columns:1fr}
    .input, textarea{
      width:100%; background:#fff; border:1px solid #d7e7ff; border-radius:12px; padding:12px 14px; font-size:16px;
      box-shadow:inset 0 1px 0 rgba(255,255,255,.6);
    }
    textarea{min-height:110px; resize:vertical}
    .submitBtn{padding:12px 14px; border-radius:12px; border:var(--btn-border); background:var(--btn-bg); font-weight:800; color:#163a5a; box-shadow:var(--btn-shadow)}
    .inline{display:flex; gap:10px; flex-wrap:wrap}
    .inline .input{flex:1}

    .deck{width:100%; max-width:900px; margin-top:12px; position:relative}
    .deck-viewport{overflow:hidden; border-radius:14px; border:var(--card-border); background:var(--glass-strong); box-shadow:0 12px 26px rgba(0,0,0,.1)}
    .deck-track{display:flex; transition:transform .6s var(--ease)}
    .wish-card{
      width:100%; flex:0 0 100%;
      padding:16px; min-height:160px;
      border-right:1px dashed rgba(207,174,124,.45);
      background:linear-gradient(180deg,#ffffff,#f6fbff);
      position:relative;
    }
    .wish-card:last-child{border-right:0}
    .wish-head{font-weight:800; color:#123}
    .wish-msg{margin-top:6px; font-family:'Playfair Display',serif; font-size:18px; color:#324}
    .wish-date{position:absolute; right:12px; bottom:10px; font-size:12px; color:#678}
    .deck-nav{display:flex; gap:10px; justify-content:center; margin-top:10px}
    .deck-btn{padding:8px 12px; border-radius:999px; border:var(--btn-border); background:var(--btn-bg); font-weight:800; color:#163a5a}

    /* Lightbox */
    .lb{position:fixed; inset:0; background:rgba(0,0,0,.86); display:none; align-items:center; justify-content:center; z-index:3000}
    .lb.open{display:flex}
    .lb img{max-width:94%; max-height:86%; border-radius:10px; box-shadow:0 20px 60px rgba(0,0,0,.6); transition:opacity .45s ease, transform .45s ease}
    .close-lb{position:fixed; right:18px; top:18px; background:rgba(255,255,255,.95); border-radius:999px; padding:8px; border:0}
    .lb-nav{position:fixed; left:6px; right:6px; top:50%; display:flex; justify-content:space-between; pointer-events:none}
    .lb-nav button{pointer-events:all; background:rgba(255,255,255,.95); border-radius:999px; padding:10px 12px; border:0}

    /* Flechas navegaci√≥n libro */
    .nav{position:fixed; top:50%; left:0; right:0; display:flex; justify-content:space-between; pointer-events:none; z-index:990; transform:translateY(-50%)}
    .nav button{pointer-events:all; background:rgba(255,255,255,.96); border:0; padding:10px 12px; border-radius:999px; font-size:28px; box-shadow:0 10px 30px rgba(0,0,0,.12)}

    /* Men√∫ lateral (cerrado por defecto) */
    .side-menu{
      position:fixed; right:16px; top:50%; transform:translateY(-50%);
      background:var(--menu-bg); border-radius:16px; box-shadow: var(--menu-shadow);
      padding:10px 8px; z-index: 995; backdrop-filter: blur(6px); display:none;
    }
    .side-menu.open{display:block}
    .side-menu a{
      display:flex; align-items:center; gap:8px;
      padding:10px 12px; border-radius:12px; margin:6px 0;
      font-weight:800; color:#233;
    }
    .side-menu a.active{ background: rgba(35,117,255,.14); }
    .menu-toggle{
      position:fixed; right:16px; bottom:16px;
      width:52px; height:52px; border-radius:50%;
      background: linear-gradient(135deg,var(--accent),var(--accent2));
      color:#fff; display:flex; align-items:center; justify-content:center; font-size:22px; border:0; box-shadow: var(--menu-shadow);
      z-index: 996;
    }

    /* Overlay entrada (toca para comenzar) */
    #entryOverlay{
      position:fixed; inset:0; z-index:4000;
      background:linear-gradient(180deg, rgba(255,255,255,.98), rgba(255,255,255,.90));
      display:flex; align-items:center; justify-content:center;
      transition:.45s ease; opacity:1; visibility:visible;
    }
    #entryOverlay.hide{ opacity:0; visibility:hidden }
    .entry-card{
      text-align:center; background:var(--glass-strong);
      border:var(--card-border);
      padding:22px; border-radius:16px; box-shadow:0 18px 60px rgba(0,0,0,.18);
      max-width:520px; width:92%;
    }

    /* Bot√≥n musical flotante (fallback) */
    #musicRetry{
      position:fixed; right:16px; bottom:80px; z-index:3500;
      width:48px; height:48px; border-radius:50%;
      display:none; align-items:center; justify-content:center;
      background: var(--music-grad); color:#1d4033; font-size:22px; box-shadow:0 10px 32px rgba(0,0,0,.18);
      border:1px solid rgba(255,255,255,.6);
      animation: pulseGlow 2.4s ease-in-out infinite;
    }
    #musicRetry[aria-hidden="false"]{ display:flex; }
    @keyframes pulseGlow{
      0%,100%{ box-shadow:0 10px 32px rgba(0,0,0,.18), 0 0 0 0 rgba(103,210,204,.22) }
      50%{ box-shadow:0 12px 40px rgba(0,0,0,.24), 0 0 0 12px rgba(103,210,204,.04) }
    }

    /* Cursor m√°gico */
    .magicHeart{
      position:fixed; pointer-events:none; z-index:99999; width:22px; height:22px; opacity:0;
      transform:translate(-50%,-50%) scale(1);
      animation:heartFade 1500ms ease-out forwards; filter:drop-shadow(0 4px 10px rgba(0,0,0,.15));
    }
    @keyframes heartFade{
      0%{opacity:.88; transform:translate(-50%,-50%) scale(1)}
      70%{opacity:.55; transform:translate(-50%,-120%) scale(.82)}
      100%{opacity:0; transform:translate(-50%,-160%) scale(.68)}
    }

    /* Responsive principales */
    @media (max-width:900px){
      .card{padding:16px; border-radius:16px; min-height:86vh}
      .ring-svg{width:170px; height:170px}
      .flip{width:78px; height:72px}
      .flip-mini{width:60px; height:60px}
      .gallery-grid img{width:44vw;height:32vw}
      .it-item{padding:14px}
    }
  </style>
</head>
<body>
  <!-- M√∫sica -->
  <audio id="marcha" src="marcha_nupcial.mp3" preload="auto" loop></audio>
  <audio id="eternamente" src="eternamente.mp3" preload="auto"></audio>

  <!-- Overlay de entrada -->
  <div id="entryOverlay" role="dialog" aria-modal="true" aria-label="Toca para entrar">
    <div class="entry-card">
      <div class="title-top">Abril &amp; Pablo</div>
      <div class="title-acepto">¬°S√≠, acepto!</div>
      <button id="entryRing" class="entry-ring" aria-label="Entrar">
        <svg class="ring-svg" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <defs>
            <radialGradient id="entryMetal" cx="50%" cy="50%" r="50%">
              <stop offset="0%" stop-color="#e9eef2"/>
              <stop offset="60%" stop-color="#c9ccd0"/>
              <stop offset="100%" stop-color="#cfae7c"/>
            </radialGradient>
            <radialGradient id="entryGem" cx="50%" cy="50%" r="50%">
              <stop offset="0%" stop-color="#dff6ff"/>
              <stop offset="60%" stop-color="#66c9ff"/>
              <stop offset="100%" stop-color="#004c99"/>
            </radialGradient>
          </defs>
          <g class="ring-rotate">
            <ellipse cx="100" cy="100" rx="40" ry="12" stroke="url(#entryMetal)" stroke-width="12" fill="none"/>
            <path d="M100 58 L110 70 L100 86 L90 70 Z" fill="url(#entryGem)" stroke="#fff" stroke-opacity="0.4" stroke-width="0.6">
              <animateTransform attributeName="transform" type="scale" values="1;1.05;1" dur="2.6s" repeatCount="indefinite"/>
            </path>
            <circle cx="100" cy="60" r="2" fill="#fff" opacity="0.9">
              <animate attributeName="r" values="2;4;2" dur="1.6s" repeatCount="indefinite"/>
            </circle>
          </g>
        </svg>
      </button>
      <div class="entry-instruction">Toca el anillo para comenzar üíç</div>
    </div>
  </div>

  <div class="viewport">
    <div class="sections" id="sections">
      <!-- P1 Portada -->
      <section id="sec-portada" class="section bg-portada active" aria-label="Portada" data-name="portada">
        <div class="overlay"></div>
        <div class="card">
          <h1 class="title-top">Abril &amp; Pablo</h1>
          <div class="title-acepto">¬°S√≠, acepto!</div>

          <!-- Anillo portada: cambia a eternamente y navega -->
          <button class="ring-button" id="ringBtn" aria-label="Anillo: abrir invitaci√≥n">
            <div class="ring-spark"></div>
            <svg class="ring-svg" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <defs>
                <radialGradient id="ringMetal" cx="50%" cy="50%" r="50%">
                  <stop offset="0%" stop-color="#e9eef2"/>
                  <stop offset="60%" stop-color="#c9ccd0"/>
                  <stop offset="100%" stop-color="#cfae7c"/>
                </radialGradient>
                <radialGradient id="blueGem" cx="50%" cy="50%" r="50%">
                  <stop offset="0%" stop-color="#dff6ff"/>
                  <stop offset="60%" stop-color="#66c9ff"/>
                  <stop offset="100%" stop-color="#004c99"/>
                </radialGradient>
              </defs>
              <g class="ring-rotate">
                <ellipse cx="100" cy="100" rx="40" ry="12" stroke="url(#ringMetal)" stroke-width="12" fill="none"/>
                <path d="M100 58 L110 70 L100 86 L90 70 Z" fill="url(#blueGem)" stroke="#fff" stroke-opacity="0.4" stroke-width="0.6">
                  <animateTransform attributeName="transform" type="scale" values="1;1.05;1" dur="2.6s" repeatCount="indefinite"/>
                </path>
                <circle cx="100" cy="60" r="2" fill="#fff" opacity="0.9">
                  <animate attributeName="r" values="2;4;2" dur="1.6s" repeatCount="indefinite"/>
                </circle>
              </g>
            </svg>
          </button>
          <div class="ring-instruction"><em>Da clic en el anillo para abrir</em></div>

          <!-- Contador mini -->
          <div class="mini-flip" id="miniFlip">
            <div class="flip-mini"><div class="face top">00</div><div class="face bottom">00</div></div>
            <div class="flip-mini"><div class="face top">00</div><div class="face bottom">00</div></div>
            <div class="flip-mini"><div class="face top">00</div><div class="face bottom">00</div></div>
            <div class="flip-mini"><div class="face top">00</div><div class="face bottom">00</div></div>
          </div>

          <p class="verse" style="margin-top:10px">"Quien halla esposa halla el bien" ‚Äî <strong>Proverbios 18:22</strong></p>

          <div class="btns" style="margin-top:10px">
            <button class="magicBtn" data-target="sec-familias">Nuestras familias</button>
            <button class="magicBtn" data-target="sec-galeria">Galer√≠a</button>
            <button class="magicBtn" data-target="sec-itinerario">Itinerario</button>
            <button class="magicBtn" data-target="sec-rsvp">Confirmar asistencia</button>
          </div>
        </div>
      </section>

      <!-- P2 Familias -->
      <section id="sec-familias" class="section bg-p1" aria-label="Familias" data-name="familias">
        <div class="overlay"></div>
        <div class="card">
          <h2 class="romantic">Nuestras familias</h2>

          <div class="parents-wrap">
            <div class="parent-block">
              <div class="parent-title">Padres de la novia</div>
              <div class="parent-names">
                Eva Aguilar Rend√≥n<br/>
                Pedro P√©rez Hern√°ndez
              </div>
            </div>

            <div class="parent-block">
              <div class="parent-title">Padres del novio</div>
              <div class="parent-names">
                Saray Hern√°ndez Santana<br/>
                Pablo Tinoco Carranza <span title="finado">‚úù</span>
              </div>
            </div>
          </div>

          <div class="honor-phrase">Tienen el honor de compartir la dicha que enlaza a sus amados hijos</div>
          <div class="couple-big" style="margin-top:8px">
            Abril P√©rez Aguilar<br/>&amp;<br/>Pablo Eliel Tinoco Hern√°ndez
          </div>
        </div>
      </section>

      <!-- P3 Foto + vers√≠culo -->
      <section id="sec-foto-verse" class="section bg-p2" aria-label="Foto y vers√≠culo" data-name="foto-verse">
        <div class="overlay"></div>
        <div class="card">
          <img src="foto1.jpg" alt="Abril y Pablo" style="width:min(520px,92%); border-radius:16px; box-shadow:0 16px 40px rgba(0,0,0,.16)" class="lb-target" data-src="foto1.jpg">
          <p class="romantic" style="text-align:center; font-size:clamp(16px,4.6vw,20px); margin-top:12px; max-width:800px">
            ‚ÄúAs√≠ que no son ya m√°s dos, sino una sola carne; por tanto, lo que Dios junt√≥, no lo separe el hombre.‚Äù ‚Äî <strong>Mateo 19:6</strong>
          </p>
        </div>
      </section>

      <!-- P4 Galer√≠a novios -->
      <section id="sec-galeria" class="section bg-p4" aria-label="Galer√≠a novios" data-name="galeria">
        <div class="overlay"></div>
        <div class="card" style="align-items:stretch">
          <h2 class="romantic" style="text-align:center">Galer√≠a ‚Äî Los novios</h2>
          <div class="gallery-grid" id="galleryGrid">
            <img src="momento1.jpg" alt="momento1" class="lb-target" data-src="momento1.jpg">
            <img src="momento2.jpg" alt="momento2" class="lb-target" data-src="momento2.jpg">
            <img src="momento3.jpg" alt="momento3" class="lb-target" data-src="momento3.jpg">
            <img src="momento4.jpg" alt="momento4" class="lb-target" data-src="momento4.jpg">
            <img src="momento5.jpg" alt="momento5" class="lb-target" data-src="momento5.jpg">
            <img src="momento6.jpg" alt="momento6" class="lb-target" data-src="momento6.jpg">
            <img src="momento7.jpg" alt="momento7" class="lb-target" data-src="momento7.jpg">
          </div>
        </div>
      </section>

      <!-- P5 Itinerario + contador -->
      <section id="sec-itinerario" class="section bg-p3" aria-label="Itinerario" data-name="itinerario">
        <div class="overlay"></div>
        <div class="card">
          <h2 class="romantic" style="text-align:center">Con cari√±o‚Ä¶</h2>
          <p class="romantic" style="text-align:center; font-size:18px; margin:6px 0 10px">
            Nos llena de alegr√≠a compartir este d√≠a contigo.<br/><strong>Fecha del evento: 28 de diciembre del 2025.</strong>
          </p>

          <div style="text-align:center">
            <div class="romantic" style="font-size:18px;color:#333">Faltan para nuestro gran d√≠a</div>
            <div class="flip-grid" id="mainFlip">
              <div class="flip"><div class="panel top">00</div><div class="panel bottom">00</div><div class="label">D√≠as</div></div>
              <div class="flip"><div class="panel top">00</div><div class="panel bottom">00</div><div class="label">Horas</div></div>
              <div class="flip"><div class="panel top">00</div><div class="panel bottom">00</div><div class="label">Minutos</div></div>
              <div class="flip"><div class="panel top">00</div><div class="panel bottom">00</div><div class="label">Segundos</div></div>
            </div>
          </div>

          <h2 class="romantic" style="text-align:center;margin-top:12px">Itinerario</h2>
          <div class="itinerary">
            <div class="it-item">
              <div class="it-icon">‚õ™</div>
              <div class="it-info">
                <strong>Ceremonia Religiosa ‚Äî 2:00 p.m.</strong>
                <div>Iglesia cristiana ‚ÄúPalabra de vida AD‚Äù</div>
                <div>Rodeo #35, Gabriel Tepepa, CP. 62980, Tlaquiltenango, Morelos</div>
                <div class="map-row">
                  <a class="map-link" href="https://maps.app.goo.gl/AWYkNZ44jyshjRUG6" target="_blank" rel="noopener">Ver ubicaci√≥n</a>
                </div>
              </div>
            </div>
            <div class="it-item">
              <div class="it-icon">üéâ</div>
              <div class="it-info">
                <strong>Recepci√≥n ‚Äî 4:00 p.m.</strong>
                <div>Jard√≠n Los Abuelos</div>
                <div>Insurgentes #819, Gabriel Tepepa, CP. 62980, Tlaquiltenango, Morelos</div>
                <div class="map-row">
                  <a class="map-link" href="https://maps.app.goo.gl/B2W65gnaMnyodGh56" target="_blank" rel="noopener">Ver ubicaci√≥n</a>
                </div>
              </div>
            </div>
            <div class="it-item">
              <div class="it-icon">üëó</div>
              <div class="it-info">
                <strong>C√≥digo de vestimenta</strong>
                <div>Formal ‚Äî Tonos recomendados: celestes, beige, verde, gris, rosa</div>
                <div class="palette">
                  <div class="chip c1" title="Celeste"></div>
                  <div class="chip c2" title="Beige"></div>
                  <div class="chip c3" title="Verde"></div>
                  <div class="chip c4" title="Gris"></div>
                  <div class="chip c5" title="Rosa"></div>
                </div>
                <div style="margin-top:6px;font-style:italic;color:#666">Dejemos el blanco para la novia.</div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- P6 Confirmaci√≥n de asistencia -->
      <section id="sec-rsvp" class="section bg-p5" aria-label="RSVP" data-name="rsvp">
        <div class="overlay"></div>
        <div class="card">
          <h2 class="romantic">Confirmaci√≥n de asistencia</h2>
          <p class="note" style="text-align:center">Tus datos se guardan autom√°ticamente en Google Sheets.</p>
          <form id="rsvpForm" class="form-wrap" autocomplete="on">
            <div class="inline">
              <input class="input" name="nombre" placeholder="Nombre del invitado" required/>
              <input class="input" name="acompanantes" placeholder="N√∫mero de acompa√±antes" inputmode="numeric" required/>
            </div>
            <div class="inline">
              <select class="input" name="confirma" required>
                <option value="">¬øConfirmas asistencia?</option>
                <option>S√≠</option>
                <option>No</option>
                <option>Tal vez</option>
              </select>
              <input class="input" name="mensaje" placeholder="Mensaje para los novios (opcional)"/>
            </div>
            <button class="submitBtn" type="submit">Confirmar asistencia</button>
            <div id="rsvpMsg" class="note" aria-live="polite"></div>
          </form>
        </div>
      </section>

      <!-- P7 Colaborativa (con momento9) -->
      <section id="sec-colaborativa" class="section bg-p6" aria-label="Galer√≠a colaborativa" data-name="colaborativa">
        <div class="overlay"></div>
        <div class="card">
          <h2 class="romantic">Galer√≠a colaborativa</h2>
          <img src="momento9.jpg" alt="momento9" style="width:min(900px,92%); border-radius:14px; box-shadow:0 14px 40px rgba(0,0,0,.14); margin-top:10px" class="lb-target" data-src="momento9.jpg">
          <p class="note" style="margin-top:8px">Comparte tus fotos o videos de la boda. ¬°Queremos ver tu perspectiva!</p>
          <div class="btns" style="margin-top:8px">
            <a class="magicBtn" href="https://docs.google.com/forms/d/e/1FAIpQLSfDX9Ky8YrQ962Uxh5ibEYGDk2WsyyVUxUPC09IcwrBKlHx7A/viewform?usp=header" target="_blank" rel="noopener">Subir tus fotos o videos</a>
          </div>
        </div>
      </section>

      <!-- P8 Momento 8 -->
      <section id="sec-momento8" class="section bg-p7" aria-label="Momento 8" data-name="momento8">
        <div class="overlay"></div>
        <div class="card">
          <img src="momento8.jpg" alt="momento8" style="width:min(900px,92%); border-radius:14px; box-shadow:0 14px 40px rgba(0,0,0,.14)">
          <p class="romantic" style="margin-top:12px; text-align:center; font-size:clamp(16px,4.6vw,20px)">
            "Tu amor es lo que he anhelado y el regalo que Dios me ha dado"
          </p>
        </div>
      </section>

      <!-- P9 Final + WhatsApp + Calendario + Buenos deseos (con carrusel) -->
      <section id="sec-final" class="section bg-p8" aria-label="Final" data-name="final">
        <div class="overlay"></div>
        <div class="card" style="align-items:stretch">
          <img src="momento5.jpg" alt="momento5" style="width:min(900px,92%); border-radius:14px; box-shadow:0 14px 40px rgba(0,0,0,.14); margin:0 auto 10px auto" class="lb-target" data-src="momento5.jpg">
          <div class="romantic" style="font-size:clamp(22px,6vw,28px); text-align:center">Con amor eterno</div>
          <div class="romantic" style="font-size:clamp(20px,5.4vw,24px); text-align:center; margin-top:6px">Abril &amp; Pablo</div>
          <div class="note" style="text-align:center">Gracias por ser parte de nuestro d√≠a especial</div>

          <div style="display:flex; gap:10px; justify-content:center; flex-wrap:wrap; margin-top:10px">
            <a class="magicBtn" href="https://wa.me/5217774914500" target="_blank" rel="noopener" aria-label="WhatsApp Abril">WhatsApp Abril</a>
            <a class="magicBtn" href="https://wa.me/5217341123645" target="_blank" rel="noopener" aria-label="WhatsApp Pablo">WhatsApp Pablo</a>
            <a class="magicBtn" href="#" id="addCalendar">Agregar al calendario</a>
          </div>

          <hr style="margin:14px 0; border:none; border-top:1px solid rgba(0,0,0,.08)"/>

          <h3 class="romantic" style="text-align:center; margin-bottom:6px">Buenos deseos</h3>
          <!-- Form buenos deseos -->
          <form id="wishForm" class="form-wrap" autocomplete="on" style="margin: 0 auto">
            <div class="inline">
              <input class="input" name="nombre" placeholder="Tu nombre" required/>
            </div>
            <textarea name="mensaje" class="input" placeholder="Escribe tus buenos deseos..." required></textarea>
            <button class="submitBtn" type="submit">Enviar buenos deseos</button>
            <div id="wishMsg" class="note" aria-live="polite"></div>
          </form>

          <!-- Carrusel -->
          <div class="deck" id="wishDeck" style="margin: 12px auto 0 auto">
            <div class="deck-viewport">
              <div class="deck-track" id="wishTrack"></div>
            </div>
            <div class="deck-nav">
              <button class="deck-btn" id="wishPrev">‚Äπ</button>
              <button class="deck-btn" id="wishNext">‚Ä∫</button>
            </div>
          </div>
        </div>
      </section>
    </div>

    <!-- Flechas libro -->
    <div class="nav" id="navArrows">
      <div><button id="prevBtn" aria-label="Anterior">‚Äπ</button></div>
      <div><button id="nextBtn" aria-label="Siguiente">‚Ä∫</button></div>
    </div>

    <!-- Men√∫ lateral -->
    <nav class="side-menu" id="sideMenu" aria-label="Navegaci√≥n r√°pida">
      <a href="#sec-portada"      data-goto="sec-portada">üè† Portada</a>
      <a href="#sec-familias"     data-goto="sec-familias">üë™ Familias</a>
      <a href="#sec-foto-verse"   data-goto="sec-foto-verse">üíû Foto &amp; Verso</a>
      <a href="#sec-galeria"      data-goto="sec-galeria">üì∏ Galer√≠a</a>
      <a href="#sec-itinerario"   data-goto="sec-itinerario">üóìÔ∏è Itinerario</a>
      <a href="#sec-rsvp"         data-goto="sec-rsvp">üíå Confirmaci√≥n</a>
      <a href="#sec-colaborativa" data-goto="sec-colaborativa">ü§≥ Colaborativa</a>
      <a href="#sec-momento8"     data-goto="sec-momento8">üíö Momento 8</a>
      <a href="#sec-final"        data-goto="sec-final">üåü Final</a>
    </nav>
    <button class="menu-toggle" id="menuToggle" aria-label="Abrir men√∫">‚ò∞</button>

    <!-- Lightbox -->
    <div class="lb" id="lightbox" aria-hidden="true" role="dialog">
      <button class="close-lb" id="lbClose" aria-label="Cerrar">‚úï</button>
      <div class="lb-nav">
        <button id="lbPrev" aria-label="Anterior">‚Äπ</button>
        <button id="lbNext" aria-label="Siguiente">‚Ä∫</button>
      </div>
      <img id="lbImg" src="" alt="Imagen ampliada">
    </div>

    <!-- M√∫sica fallback -->
    <button id="musicRetry" aria-label="Reproducir m√∫sica" title="Reproducir m√∫sica" aria-hidden="true">üéµ</button>
  </div>

  <script>
    /* ========= CONFIG GLOBALES ========= */
    const order = [
      'sec-portada','sec-familias','sec-foto-verse','sec-galeria',
      'sec-itinerario','sec-rsvp','sec-colaborativa','sec-momento8','sec-final'
    ];
    const sections = order.map(id => document.getElementById(id));
    let current = 0, firstNavDone = false, wheelLock = false;

    const sideMenu = document.getElementById('sideMenu');
    const menuToggle = document.getElementById('menuToggle');

    function markActiveInMenu(id){
      sideMenu.querySelectorAll('a').forEach(a=>a.classList.toggle('active', a.getAttribute('data-goto')===id));
    }

    function setStates(idx){
      sections.forEach((s,i)=>{
        s.classList.remove('active','prev','next');
        if(i<idx) s.classList.add('prev'); else if(i>idx) s.classList.add('next');
      });
      sections[idx].classList.add('active');
    }
    function show(i, playSound=true){
      i = ((i % sections.length) + sections.length) % sections.length;
      if (i !== current && firstNavDone && playSound) playFlipSoundBook();
      setStates(i);
      current = i;
      const hide = (order[i] === 'sec-portada');
      document.querySelectorAll('#navArrows button').forEach(b=>b.style.display = hide ? 'none':'block');
      markActiveInMenu(order[i]);
      if (i!==0) firstNavDone = true;
    }
    show(0,false);

    /* Scroll tipo libro */
    function onWheel(e){
      if(wheelLock) return;
      wheelLock = true;
      const dy = e.deltaY;
      if(Math.abs(dy) < 10){ wheelLock = false; return; }
      if(dy > 0) show(current+1); else show(current-1);
      setTimeout(()=>wheelLock=false, 650);
    }
    window.addEventListener('wheel', onWheel, {passive:true});

    document.getElementById('prevBtn').addEventListener('click',()=>show(current-1));
    document.getElementById('nextBtn').addEventListener('click',()=>show(current+1));

    window.addEventListener('keydown', (e) => {
      if(e.key==='ArrowRight' || e.key==='PageDown') show(current+1);
      if(e.key==='ArrowLeft'  || e.key==='PageUp')   show(current-1);
      if(e.key==='Home') show(0);
      if(e.key==='End')  show(order.length-1);
      if(e.key==='Escape' && lb.classList.contains('open')) closeLb();
    });

    /* Men√∫ lateral (cerrado por defecto) */
    menuToggle.addEventListener('click',()=> sideMenu.classList.toggle('open'));
    sideMenu.querySelectorAll('a[data-goto]').forEach(a=>{
      a.addEventListener('click', (e)=>{
        e.preventDefault();
        const id=a.getAttribute('data-goto');
        const idx=order.indexOf(id);
        if(idx>=0){ show(idx); sideMenu.classList.remove('open'); }
      });
    });

    /* Botones m√°gicos portada */
    document.querySelectorAll('.magicBtn[data-target]').forEach(btn=>{
      btn.addEventListener('click',()=>{
        const tgt=btn.getAttribute('data-target');
        const i=order.indexOf(tgt);
        if(i>=0){ show(i); sideMenu.classList.remove('open'); }
      });
    });

    /* ==== Audio / Anillos ==== */
    const marcha=document.getElementById('marcha');
    const eternamente=document.getElementById('eternamente');
    const musicRetry=document.getElementById('musicRetry');
    const entryOverlay=document.getElementById('entryOverlay');
    const entryRing=document.getElementById('entryRing');

    function playUnlocked(audio){
      try{
        const p = audio.play();
        if(p && typeof p.then==='function'){ return p.then(()=>true).catch(()=>false); }
        return Promise.resolve(true);
      }catch(_){ return Promise.resolve(false); }
    }
    async function startMarcha(){
      try{
        marcha.currentTime = 0;
        marcha.volume = 1;
        const ok = await playUnlocked(marcha);
        if(!ok) musicRetry.setAttribute('aria-hidden','false');
      }catch(_){
        musicRetry.setAttribute('aria-hidden','false');
      }
    }
    function fadeAudio(audio, from, to, duration=2000){
      return new Promise(res=>{
        const steps=40, dt=duration/steps;
        let i=0;
        audio.volume = Math.max(0, Math.min(1, from));
        const id=setInterval(()=>{
          i++;
          audio.volume = Math.max(0, Math.min(1, from + (to-from)*(i/steps)));
          if(i>=steps){ clearInterval(id); audio.volume = Math.max(0, Math.min(1, to)); res(); }
        }, dt);
      });
    }

    // Overlay: arranca marcha y cierra
    entryRing.addEventListener('click', async ()=>{
      await startMarcha();
      entryOverlay.classList.add('hide');
    });

    // Fallback m√∫sica
    musicRetry.addEventListener('click', async ()=>{
      const ok = await playUnlocked(marcha);
      if(ok){ musicRetry.setAttribute('aria-hidden','true'); }
    });

    // Anillo portada: crossfade a eternamente y pasar a Familias
    document.getElementById('ringBtn').addEventListener('click', async ()=>{
      try{ if(!marcha.paused){ await fadeAudio(marcha, marcha.volume||1, 0, 2000); marcha.pause(); } }catch(e){}
      try{
        eternamente.currentTime=0; eternamente.volume=0;
        const ok = await playUnlocked(eternamente);
        if(ok){ await fadeAudio(eternamente,0,1,2000); }
      }catch(e){}
      const idx = order.indexOf('sec-familias');
      if(idx>=0) show(idx);
      const ringBtn=document.getElementById('ringBtn');
      ringBtn.classList.add('clicked'); setTimeout(()=>ringBtn.classList.remove('clicked'),900);
    });

    /* Sonido de cambio de p√°gina (sutil) */
    function playFlipSoundBook(){
      try{
        const ctx = window._audioCtx || new (window.AudioContext||window.webkitAudioContext)();
        window._audioCtx = ctx;
        const t = ctx.currentTime;

        const o1 = ctx.createOscillator(), g1 = ctx.createGain();
        o1.type='sawtooth'; o1.frequency.setValueAtTime(180, t);
        o1.frequency.exponentialRampToValueAtTime(120, t+0.08);
        g1.gain.setValueAtTime(0.0001, t);
        g1.gain.exponentialRampToValueAtTime(0.16, t+0.02);
        g1.gain.exponentialRampToValueAtTime(0.0001, t+0.14);
        o1.connect(g1).connect(ctx.destination); o1.start(t); o1.stop(t+0.16);
      }catch(e){}
    }

    /* Contadores */
    const target=new Date('2025-12-28T14:00:00');
    const pad=n=>String(n).padStart(2,'0');

    function animateMini(flipEl,newVal){
      const [top, bot] = [flipEl.querySelector('.top'), flipEl.querySelector('.bottom')];
      if(top.textContent===newVal) return;
      bot.textContent=newVal;
      flipEl.classList.remove('animate'); void flipEl.offsetWidth; flipEl.classList.add('animate');
      setTimeout(()=>{ top.textContent=newVal; flipEl.classList.remove('animate'); },700);
    }
    function tickMini(){
      const now=new Date(); let diff=Math.max(0, target-now);
      const d=Math.floor(diff/86400000); diff-=d*86400000;
      const h=Math.floor(diff/3600000);  diff-=h*3600000;
      const m=Math.floor(diff/60000);    diff-=m*60000;
      const s=Math.floor(diff/1000);
      const flips=document.querySelectorAll('#miniFlip .flip-mini');
      const vals=[String(d), pad(h), pad(m), pad(s)];
      flips.forEach((f,i)=>animateMini(f, vals[i]));
    }
    setInterval(tickMini,1000);

    function animateFlip(flipEl,newVal){
      const top=flipEl.querySelector('.top'); const bottom=flipEl.querySelector('.bottom');
      if(top.textContent.trim()===newVal) return;
      bottom.textContent=newVal;
      flipEl.classList.remove('animate'); void flipEl.offsetWidth; flipEl.classList.add('animate');
      setTimeout(()=>{ top.textContent=newVal; flipEl.classList.remove('animate'); },700);
    }
    function tickMain(){
      const now=new Date(); let diff=Math.max(0, target-now);
      const days=Math.floor(diff/86400000); diff-=days*86400000;
      const hours=Math.floor(diff/3600000); diff-=hours*3600000;
      const mins=Math.floor(diff/60000);    diff-=mins*60000;
      const secs=Math.floor(diff/1000);
      const flips=[...document.querySelectorAll('#mainFlip .flip')];
      const vals=[String(days), pad(hours), pad(mins), pad(secs)];
      flips.forEach((f,i)=>animateFlip(f, vals[i]));
    }
    setInterval(tickMain,1000);

    /* Lightbox */
    const lb=document.getElementById('lightbox');
    const lbImg=document.getElementById('lbImg');
    const lbClose=document.getElementById('lbClose');
    const lbPrev=document.getElementById('lbPrev');
    const lbNext=document.getElementById('lbNext');

    const lbTargets=[...document.querySelectorAll('.lb-target')];
    const lbSrcs=lbTargets.map(t=>t.dataset.src||t.getAttribute('src'));
    let lbIndex=0;

    lbTargets.forEach((t,i)=>t.addEventListener('click', ()=>openLb(i)));

    function openLb(i){
      lbIndex=i; lbImg.style.opacity=0; lbImg.src=lbSrcs[lbIndex];
      lb.classList.add('open'); lb.setAttribute('aria-hidden','false');
      setTimeout(()=>{ lbImg.style.transition='opacity .45s ease, transform .45s ease'; lbImg.style.opacity=1; lbImg.style.transform='scale(1)'; },40);
    }
    function closeLb(){ lb.classList.remove('open'); lbImg.src=''; lb.setAttribute('aria-hidden','true'); }
    function lbShow(dir){
      lbIndex=(lbIndex+(dir>0?1:-1)+lbSrcs.length)%lbSrcs.length;
      lbImg.style.opacity=0;
      setTimeout(()=>{ lbImg.src=lbSrcs[lbIndex]; lbImg.style.opacity=1; },260);
    }
    lbClose.addEventListener('click', closeLb);
    lbPrev.addEventListener('click', ()=>lbShow(-1));
    lbNext.addEventListener('click', ()=>lbShow(1));
    lb.addEventListener('click', (e)=>{ if(e.target===lb) closeLb(); });

    /* Galer√≠a auto-focus suave */
    const galleryImgs=[...document.querySelectorAll('#galleryGrid img')];
    let gIdx=0; function paintGallery(){ galleryImgs.forEach((im,i)=>im.style.opacity=(i===gIdx?1:.52)); }
    function gNext(){ gIdx=(gIdx+1)%galleryImgs.length; paintGallery(); }
    paintGallery();
    let gAuto=setInterval(gNext,4200);
    document.getElementById('galleryGrid').addEventListener('mouseenter',()=>{ clearInterval(gAuto); gAuto=null; });
    document.getElementById('galleryGrid').addEventListener('mouseleave',()=>{ if(!gAuto) gAuto=setInterval(gNext,4200); });

    /* Calendario */
    document.getElementById('addCalendar').addEventListener('click',(e)=>{
      e.preventDefault();
      const start='20251228T140000', end='20251228T230000';
      const title=encodeURIComponent('Boda ‚Äî Abril & Pablo');
      const details=encodeURIComponent('Ceremonia y recepci√≥n ‚Äî Abril & Pablo');
      const location=encodeURIComponent('Iglesia Cristiana Palabra de Vida AD / Jard√≠n Los Abuelos, Tlaquiltenango, Morelos');
      const url=`https://www.google.com/calendar/render?action=TEMPLATE&text=${title}&dates=${start}/${end}&details=${details}&location=${location}`;
      window.open(url,'_blank','noopener');
    });

    /* Cursor m√°gico */
    function heart(x,y){
      const h=document.createElement('div');
      h.className='magicHeart';
      const size=16 + Math.random()*14;
      h.style.width=size+'px'; h.style.height=size+'px';
      const jitter=18; h.style.left=(x+(Math.random()*jitter-jitter/2))+'px'; h.style.top=(y+(Math.random()*jitter-jitter/2))+'px';
      const r=Math.random();
      if(r<0.25) h.style.background='radial-gradient(circle,#ffffff,#f0f0f0)';
      else if(r<0.5) h.style.background='radial-gradient(circle,#4dc3ff,#bfeeff)';
      else if(r<0.75) h.style.background='radial-gradient(circle,#c8c8c8,#ffffff)';
      else h.style.background='radial-gradient(circle,#a7ffcf,#eafff0)';
      h.style.clipPath='polygon(50% 0%,61% 15%,75% 15%,84% 27%,84% 45%,75% 60%,50% 80%,25% 60%,16% 45%,16% 27%,25% 15%,39% 15%)';
      document.body.appendChild(h);
      setTimeout(()=>h.remove(), 1500 + Math.random()*400);
    }
    function splash(x,y){ for(let i=0;i<3+Math.floor(Math.random()*3);i++){ setTimeout(()=>heart(x,y), i*60); } }
    document.addEventListener('mousemove',(e)=>{ if(Math.random()>0.6) return; splash(e.clientX,e.clientY); });
    document.addEventListener('click',(e)=>{ splash(e.clientX,e.clientY); });
    document.addEventListener('touchstart',(e)=>{ const t=e.touches[0]; if(!t) return; splash(t.clientX,t.clientY); },{passive:true});
    document.addEventListener('touchmove',(e)=>{ const t=e.touches[0]; if(!t) return; if(Math.random()>0.6) return; splash(t.clientX,t.clientY); },{passive:true});

    /* ======== Formularios: endpoints Apps Script ======== */
    // Usamos los enlaces m√°s recientes que nos diste:
    const RSVP_URL   = "https://script.google.com/macros/s/AKfycbzYrKGi5QKiVY38tiIU27bCjWiVXcjTXq13Xsz56q6rhcUuqwB_gBuPnD2SsjmR5kk6Rg/exec";
    const WISHES_URL = "https://script.google.com/macros/s/AKfycbxEJOttpB7zeeQ93iJV7wUsTn9dIAVqYn-Z_SThrPg9wNgijWGPOF5YScg3OjF5hC5g/exec";

    // RSVP (P6)
    document.getElementById('rsvpForm').addEventListener('submit', async (e)=>{
      e.preventDefault();
      const fd = new FormData(e.target);
      const payload = new URLSearchParams({
        nombre: (fd.get('nombre')||'').trim(),
        acompanantes: (fd.get('acompanantes')||'').trim(),
        confirma: (fd.get('confirma')||'').trim(),
        mensaje: (fd.get('mensaje')||'').trim()
      });
      const msg = document.getElementById('rsvpMsg');
      msg.textContent = 'Enviando‚Ä¶';
      try{
        const res = await fetch(RSVP_URL, { method:'POST', mode:'no-cors', body: payload });
        // Apps Script con no-cors no devuelve body legible; asumimos ok si no lanza
        msg.textContent = '¬°Gracias! Tu confirmaci√≥n fue registrada.';
        e.target.reset();
      }catch(err){
        msg.textContent = 'No se pudo enviar. Verifica conexi√≥n e int√©ntalo de nuevo.';
      }
    });

    /* Buenos deseos (P9) */
    async function fetchWishes(){
      try{
        const res = await fetch(WISHES_URL, { method:'GET', cache:'no-store' });
        const data = await res.json().catch(()=>[]);
        return Array.isArray(data) ? data : [];
      }catch(e){ return []; }
    }
    function renderWishes(list){
      const track = document.getElementById('wishTrack');
      track.innerHTML = '';
      if(!list.length){
        const d=document.createElement('div');
        d.className='wish-card';
        d.innerHTML='<div class="wish-head">S√© el primero en escribir un buen deseo üíñ</div>';
        track.appendChild(d);
      }else{
        list.forEach(w=>{
          const card=document.createElement('div');
          card.className='wish-card';
          const nombre = (w.nombre||'An√≥nimo');
          const mensaje = (w.mensaje||w.deseo||'üíå');
          const fecha = w.fecha||w.date||'';
          card.innerHTML = `
            <div class="wish-head">${nombre}</div>
            <div class="wish-msg">${mensaje}</div>
            <div class="wish-date">${fecha}</div>
          `;
          track.appendChild(card);
        });
      }
      // reset posici√≥n
      deckIndex = 0;
      track.style.transform = `translateX(0)`;
    }
    let deckIndex=0;
    function moveDeck(dir){
      const track = document.getElementById('wishTrack');
      const total = track.children.length;
      deckIndex = (deckIndex + (dir>0?1:-1) + total) % total;
      track.style.transform = `translateX(-${deckIndex*100}%)`;
    }
    document.getElementById('wishPrev').addEventListener('click',()=>moveDeck(-1));
    document.getElementById('wishNext').addEventListener('click',()=>moveDeck(1));

    document.getElementById('wishForm').addEventListener('submit', async (e)=>{
      e.preventDefault();
      const fd = new FormData(e.target);
      const payload = new URLSearchParams({
        nombre: (fd.get('nombre')||'').trim(),
        mensaje: (fd.get('mensaje')||'').trim()
      });
      const msg = document.getElementById('wishMsg');
      msg.textContent = 'Enviando‚Ä¶';
      try{
        await fetch(WISHES_URL, { method:'POST', mode:'no-cors', body: payload });
        msg.textContent = '¬°Gracias por tus palabras! üíï';
        e.target.reset();
        // refrescar carrusel
        const list = await fetchWishes();
        renderWishes(list);
      }catch(err){
        msg.textContent = 'No se pudo enviar. Intenta de nuevo.';
      }
    });

    // Cargar deseos al entrar a la p√°gina final (y al inicio por si acaso)
    (async()=>{
      const initial = await fetchWishes();
      renderWishes(initial);
    })();

    /* Iniciar contadores al cargar */
    function initCounters(){ tickMini(); tickMain(); }
    window.addEventListener('load', initCounters);
  </script>
</body>
</html>
