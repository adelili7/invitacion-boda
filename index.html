<!doctype html>
<html lang="es">
<head>
  <!-- ==============================================================
       Boda de Abril & Pablo ‚Äî Invitaci√≥n (Libro + Scroll Suave)
       Parte 1/3: Head, estilos, Portada (p1), Familias (p2), Foto&Verso (p3)
       Tipograf√≠a rom√°ntica principal: Cormorant Garamond
       ============================================================== -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#ffffff" />
  <title>Boda de Abril & Pablo üíç</title>

  <!-- Fuentes -->
  <link href="https://fonts.cdnfonts.com/css/waltograph" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400;1,600&family=Quicksand:wght@300;400;600;700&display=swap" rel="stylesheet" />

  <style>
    /* ========================= VARIABLES ========================= */
    :root{
      --bg-cream:#F8F5F0;
      --deep:#2B2A2F;
      --glass:rgba(255,255,255,0.86);
      --glass-strong:rgba(255,255,255,0.95);
      --rose:#d6a79b;
      --accent:#66c9ff;
      --accent2:#4a8fe7;
      --wa:#25D366;
      --shadow:0 18px 50px rgba(0,0,0,.12);
      --ease:cubic-bezier(.2,.9,.2,1);

      /* Dress code chips */
      --chip-celeste:#a8dadc;
      --chip-beige:#efe5d0;
      --chip-verde:#a8e6cf;
      --chip-gris:#c5ced6;
      --chip-rosa:#f7b6b1;

      --menu-bg: rgba(255,255,255,.92);
      --menu-shadow: 0 12px 28px rgba(0,0,0,.12);

      /* Bot√≥n musical flotante con paleta */
      --music-grad: linear-gradient(135deg, #ffffff 0%, #9fd7ff 28%, #cfcfcf 64%, #a7ffcf 100%);
    }

    /* ========================= BASE ========================= */
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg-cream);color:var(--deep);font-family:Quicksand,system-ui,Arial;-webkit-font-smoothing:antialiased; scroll-behavior:smooth}
    img{max-width:100%;height:auto;display:block}
    a{color:inherit;text-decoration:none}
    button{font-family:inherit;cursor:pointer;outline:none}

    /* ========================= LAYOUT libro ========================= */
    .viewport{height:100vh;overflow:hidden;position:relative;background:var(--bg-cream)}
    .sections{height:100%;width:100%;position:relative;perspective:1200px;}

    .section{
      position:absolute; inset:0;
      display:flex; align-items:center; justify-content:center;
      padding:26px;
      background-size:cover; background-position:center; background-attachment:fixed;
      opacity:0; transform:rotateY(90deg) translateZ(-200px); transform-origin:center;
      transition:transform .9s var(--ease), opacity .6s ease; backface-visibility:hidden;
      will-change:transform,opacity;
    }
    .section.active{opacity:1; transform:rotateY(0) translateZ(0)}
    .section.prev  {opacity:0; transform:rotateY(-90deg) translateZ(-200px)}
    .section.next  {opacity:0; transform:rotateY( 90deg) translateZ(-200px)}
    .overlay{position:absolute; inset:0; background:linear-gradient(180deg,rgba(255,255,255,.28),rgba(255,255,255,.6)); pointer-events:none}

    /* ========================= FONDOS POR P√ÅGINA ========================= */
    .bg-portada {background-image:url('fondo_floral.jpg')}
    .bg-p1      {background-image:url('fondo_floral1.png')}
    .bg-p2      {background-image:url('fondo_floral2.jpg')}
    .bg-p3      {background-image:url('fondo_floral3.jpg')}
    .bg-p4      {background-image:url('fondo_floral4.png')}
    .bg-p5      {background-image:url('fondo_floral5.jpg')}
    .bg-p6      {background-image:url('fondo_floral6.jpg')}
    .bg-p7      {background-image:url('fondo_floral7.jpg')}
    .bg-p8      {background-image:url('fondo_floral9.jpg')}
    .bg-p9      {background-image:url('fondo_floral8.png')}

    /* ========================= CARD ========================= */
    .card{
      position:relative; z-index:2;
      max-width:980px; width:100%;
      background:var(--glass); backdrop-filter: blur(6px);
      border-radius:16px; padding:28px; box-shadow:var(--shadow);
    }

    /* ========================= TIPOGRAF√çA ========================= */
    h1,h2,h3,h4{font-family:'Cormorant Garamond',serif;margin:0 0 10px}
    .romantic{font-family:'Cormorant Garamond',serif}
    .title-top{font-size:48px; letter-spacing:.4px; text-align:center}
    .title-acepto{
      font-family:'Waltograph',cursive;
      font-size:42px; margin-top:6px; text-align:center;
      background:linear-gradient(135deg,#fff,#f7e8c5 45%,#e3c792 70%,#fff);
      -webkit-background-clip:text; background-clip:text; color:transparent;
      text-shadow:0 0 18px rgba(255,255,255,.45), 0 0 6px rgba(230,186,120,.45);
      animation: glowGold 2.8s ease-in-out infinite;
    }
    @keyframes glowGold{
      0%,100%{ text-shadow:0 0 12px rgba(255,255,255,.35), 0 0 4px rgba(230,186,120,.35) }
      50%{    text-shadow:0 0 22px rgba(255,255,255,.55), 0 0 10px rgba(230,186,120,.55) }
    }
    .verse{
      font-family:'Cormorant Garamond',serif; font-style:italic; margin-top:14px; font-size:18px;
      background:linear-gradient(90deg,#b98f5a,#d6a79b);
      -webkit-background-clip:text; background-clip:text; color:transparent;
      text-align:center;
    }
    .note{color:#555; font-size:14px}

    /* ========================= BOTONES M√ÅGICOS ========================= */
    .btns{margin-top:14px; display:flex; gap:10px; justify-content:center; flex-wrap:wrap}
    .magicBtn{
      padding:10px 14px; border-radius:12px; border:0;
      background:linear-gradient(135deg,var(--accent),var(--accent2)); color:#fff; font-weight:700;
      box-shadow:0 10px 30px rgba(74,143,231,.18); transition:filter .2s, transform .2s, box-shadow .2s;
    }
    .magicBtn:hover{filter:brightness(1.05); transform:translateY(-1px); box-shadow:0 12px 36px rgba(74,143,231,.26)}

    /* ========================= ANILLO (portada y overlay) ========================= */
    .ring-button{background:transparent; border:0; padding:0; cursor:pointer; display:block; margin:12px auto; position:relative}
    .ring-svg{width:220px; height:220px; display:block}
    .ring-rotate{animation:ringSpin 14s linear infinite; transform-origin:110px 110px}
    @keyframes ringSpin{to{transform:rotate(360deg)}}
    .ring-spark{position:absolute; left:50%; top:35%; width:140px; height:140px; transform:translate(-50%,-50%); pointer-events:none; border-radius:50%; opacity:0}
    .ring-button.clicked .ring-spark{animation:spark 900ms ease-out forwards}
    @keyframes spark{0%{opacity:0; transform:translate(-50%,-50%) scale(.6)} 30%{opacity:1; transform:translate(-50%,-50%) scale(1.05)} 100%{opacity:0; transform:translate(-50%,-50%) scale(1.6)}}
    .ring-instruction{font-size:13px;color:#333;margin-top:6px;text-align:center}

    /* ========================= CONTADOR MINI (PORTADA) ========================= */
    .mini-flip{display:flex; gap:10px; justify-content:center; margin-top:12px; align-items:center}
    .flip-mini{width:72px; height:72px; perspective:800px; position:relative}
    .flip-mini .face{
      position:absolute; left:0; top:0; width:100%; height:50%;
      overflow:hidden; border-radius:12px; background:var(--glass-strong);
      display:flex; align-items:center; justify-content:center;
      font-weight:800; font-size:22px; font-family:'Cormorant Garamond',serif;
      box-shadow:0 10px 26px rgba(0,0,0,.08);
    }
    .flip-mini .top{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:bottom}
    .flip-mini .bottom{top:50%;border-top-left-radius:0;border-top-right-radius:0;transform-origin:top}
    .flip-mini.animate .top{animation:flipTop .7s forwards}
    .flip-mini.animate .bottom{animation:flipBottom .7s forwards}

    /* ========================= FOTO + VERSO ========================= */
    .photo-romantic{
      width:520px; max-width:92%; border-radius:16px; box-shadow:0 16px 42px rgba(0,0,0,.16);
      object-fit:cover; transition:transform .45s var(--ease), opacity .45s var(--ease);
    }
    .photo-romantic:hover{transform:scale(1.03)}
    .verse-big{font-family:'Cormorant Garamond',serif; font-size:20px; margin-top:12px; text-align:center}

    /* ========================= P√ÅGINA 2 ‚Äî FAMILIAS (responsive) ========================= */
    .parents-wrap{
      display:flex; flex-direction:column; gap:18px; align-items:stretch; justify-content:center; margin-top:12px;
    }
    .parent-block{
      background:var(--glass-strong); border-radius:14px; padding:16px; box-shadow:0 10px 28px rgba(0,0,0,.08);
    }
    .parent-title{font-family:'Cormorant Garamond',serif; font-weight:700; font-size:22px; text-align:center; margin-bottom:8px}
    .parent-names{font-family:'Cormorant Garamond',serif; font-size:20px; line-height:1.35; text-align:center}
    .romantic-phrase{font-family:'Cormorant Garamond',serif; font-style:italic; font-size:20px; text-align:center; margin-top:16px}
    .couple-names{font-family:'Cormorant Garamond',serif; font-weight:700; font-size:30px; margin-top:14px; text-align:center}

    /* En pantallas grandes, los dos bloques se ponen lado a lado con el mismo tama√±o */
    @media(min-width:800px){
      .parents-wrap{flex-direction:row}
      .parent-block{flex:1}
      .parent-names{font-size:22px}
      .couple-names{font-size:36px}
    }

    /* ========================= OVERLAY ENTRADA (para audio m√≥vil) ========================= */
    #entryOverlay{
      position:fixed; inset:0; z-index:4000;
      background:linear-gradient(180deg, rgba(255,255,255,.96), rgba(255,255,255,.88));
      display:flex; align-items:center; justify-content:center;
      transition: opacity .45s ease, visibility .45s ease;
    }
    #entryOverlay.hide{ opacity:0; visibility:hidden }
    .entry-card{
      text-align:center; background:var(--glass-strong);
      padding:22px; border-radius:16px; box-shadow:0 18px 60px rgba(0,0,0,.18);
      max-width:520px; width:92%;
    }
    .entry-title{ font-family:'Cormorant Garamond',serif; font-size:28px; margin-bottom:6px }
    .entry-sub{ color:#666; margin-bottom:12px }
    .entry-ring{ background:transparent; border:0; padding:0; cursor:pointer; display:block; margin:10px auto; position:relative }

    /* ========================= RESPONSIVE M√ìVIL ========================= */
    @media (max-width:900px){
      .title-top{font-size:40px}
      .title-acepto{font-size:32px}
      .ring-svg{width:160px;height:160px}
      .card{padding:16px;border-radius:12px}
    }

    /* ========================= CURSOR M√ÅGICO (estilos base) ========================= */
    .magicHeart{
      position:fixed; pointer-events:none; z-index:99999;
      width:22px; height:22px; opacity:0;
      transform:translate(-50%,-50%) scale(1);
      animation:heartFade 1500ms ease-out forwards;
      filter:drop-shadow(0 4px 10px rgba(0,0,0,.15));
    }
    @keyframes heartFade{
      0%  {opacity:.88; transform:translate(-50%,-50%) scale(1)}
      70% {opacity:.55; transform:translate(-50%,-120%) scale(.82)}
      100%{opacity:0;   transform:translate(-50%,-160%) scale(.68)}
    }

    /* Animaciones flip (compartidas) */
    @keyframes flipTop{0%{transform:rotateX(0)}100%{transform:rotateX(-180deg)}}
    @keyframes flipBottom{0%{transform:rotateX(180deg)}100%{transform:rotateX(0)}}
  </style>
</head>
<body>

  <!-- ========================= AUDIOS (se controlan en Parte 3) ========================= -->
  <audio id="marcha" src="marcha_nupcial.mp3" preload="auto" loop></audio>
  <audio id="eternamente" src="eternamente.mp3" preload="auto"></audio>

  <!-- ========================= OVERLAY DE ENTRADA (toca para habilitar audio) ========================= -->
  <div id="entryOverlay" role="dialog" aria-modal="true" aria-label="Toca para entrar">
    <div class="entry-card">
      <div class="entry-title">Toca para comenzar üíç</div>
      <div class="entry-sub">Pulsa el anillo para activar la m√∫sica y entrar a la invitaci√≥n.</div>
      <button id="entryRing" class="entry-ring" aria-label="Entrar">
        <svg class="ring-svg" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <defs>
            <radialGradient id="entryMetal" cx="50%" cy="50%" r="50%">
              <stop offset="0%" stop-color="#e9eef2"/>
              <stop offset="60%" stop-color="#c9ccd0"/>
              <stop offset="100%" stop-color="var(--rose)"/>
            </radialGradient>
            <radialGradient id="entryGem" cx="50%" cy="50%" r="50%">
              <stop offset="0%" stop-color="#dff6ff"/>
              <stop offset="60%" stop-color="#66c9ff"/>
              <stop offset="100%" stop-color="#004c99"/>
            </radialGradient>
          </defs>
          <g class="ring-rotate">
            <ellipse cx="100" cy="100" rx="40" ry="12" stroke="url(#entryMetal)" stroke-width="12" fill="none"/>
            <path d="M100 58 L110 70 L100 86 L90 70 Z" fill="url(#entryGem)" stroke="#fff" stroke-opacity="0.4" stroke-width="0.6">
              <animateTransform attributeName="transform" type="scale" values="1;1.05;1" dur="2.6s" repeatCount="indefinite"/>
            </path>
            <circle cx="100" cy="60" r="2" fill="#fff" opacity="0.9">
              <animate attributeName="r" values="2;4;2" dur="1.6s" repeatCount="indefinite"/>
            </circle>
          </g>
        </svg>
      </button>
      <div class="entry-instruction" style="font-size:13px;color:#333;margin-top:8px">Toca el anillo para entrar</div>
    </div>
  </div>

  <div class="viewport">
    <div class="sections" id="sections">

      <!-- ====================== P√ÅGINA 1 ‚Äî PORTADA ====================== -->
      <section id="sec-portada" class="section bg-portada active" aria-label="Portada" data-name="portada">
        <div class="overlay"></div>
        <div class="card" style="text-align:center">
          <h1 class="title-top romantic">Abril &amp; Pablo</h1>
          <div class="title-acepto">S√≠, ¬°acepto!</div>

          <!-- Anillo portada: al tocar cambiar√° a "eternamente" (script en Parte 3) -->
          <button class="ring-button" id="ringBtn" aria-label="Anillo: abrir invitaci√≥n">
            <div class="ring-spark"></div>
            <svg class="ring-svg" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <defs>
                <radialGradient id="ringMetal" cx="50%" cy="50%" r="50%">
                  <stop offset="0%" stop-color="#e9eef2"/>
                  <stop offset="60%" stop-color="#c9ccd0"/>
                  <stop offset="100%" stop-color="var(--rose)"/>
                </radialGradient>
                <radialGradient id="blueGem" cx="50%" cy="50%" r="50%">
                  <stop offset="0%" stop-color="#dff6ff"/>
                  <stop offset="60%" stop-color="#66c9ff"/>
                  <stop offset="100%" stop-color="#004c99"/>
                </radialGradient>
              </defs>
              <g class="ring-rotate">
                <ellipse cx="100" cy="100" rx="40" ry="12" stroke="url(#ringMetal)" stroke-width="12" fill="none"/>
                <path d="M100 58 L110 70 L100 86 L90 70 Z" fill="url(#blueGem)" stroke="#fff" stroke-opacity="0.4" stroke-width="0.6">
                  <animateTransform attributeName="transform" type="scale" values="1;1.05;1" dur="2.6s" repeatCount="indefinite"/>
                </path>
                <circle cx="100" cy="60" r="2" fill="#fff" opacity="0.9">
                  <animate attributeName="r" values="2;4;2" dur="1.6s" repeatCount="indefinite"/>
                </circle>
              </g>
            </svg>
          </button>
          <div class="ring-instruction"><em>Da clic en el anillo para abrir</em></div>

          <!-- Contador mini (flip) ‚Äî funcional en Parte 3 -->
          <div class="mini-flip" id="miniFlip" aria-hidden="true">
            <div class="flip-mini" data-k="d"><div class="face top">00</div><div class="face bottom">00</div></div>
            <div class="flip-mini" data-k="h"><div class="face top">00</div><div class="face bottom">00</div></div>
            <div class="flip-mini" data-k="m"><div class="face top">00</div><div class="face bottom">00</div></div>
            <div class="flip-mini" data-k="s"><div class="face top">00</div><div class="face bottom">00</div></div>
          </div>

          <!-- Vers√≠culo corto -->
          <p class="verse">"Quien halla esposa halla el bien" ‚Äî <strong class="romantic">Proverbios 18:22</strong></p>

          <!-- Botones portada -->
          <div class="btns">
            <button class="magicBtn" data-target="sec-familias">Nuestras familias</button>
            <button class="magicBtn" data-target="sec-itinerario">Itinerario</button>
            <button class="magicBtn" data-target="sec-galeria">Galer√≠a</button>
            <button class="magicBtn" data-target="sec-rsvp">Confirmar asistencia</button>
          </div>
        </div>
      </section>

      <!-- ====================== P√ÅGINA 2 ‚Äî FAMILIAS ====================== -->
      <section id="sec-familias" class="section bg-p1" aria-label="Nuestras familias" data-name="familias">
        <div class="overlay"></div>
        <div class="card">
          <h2 class="romantic" style="text-align:center">Padres de los novios</h2>

          <div class="parents-wrap">
            <!-- Bloque NOVIA -->
            <div class="parent-block">
              <div class="parent-title">Padres de la novia</div>
              <div class="parent-names">
                <strong>Eva Aguilar Rend√≥n</strong><br/>
                <strong>Pedro P√©rez Hern√°ndez</strong>
              </div>
            </div>

            <!-- Bloque NOVIO -->
            <div class="parent-block">
              <div class="parent-title">Padres del novio</div>
              <div class="parent-names">
                <strong>Saray Hern√°ndez Santana</strong><br/>
                <strong>Pablo Tinoco Carranza <span title="finado">‚úù</span></strong>
              </div>
            </div>
          </div>

          <div class="romantic-phrase">‚ÄúTienen el honor de compartir la dicha que enlaza a sus amados hijos.‚Äù</div>
          <div class="couple-names">Abril P√©rez Aguilar &amp; Pablo Eliel Tinoco Hern√°ndez</div>
        </div>
      </section>

      <!-- ====================== P√ÅGINA 3 ‚Äî FOTO + VERS√çCULO ====================== -->
      <section id="sec-foto-verse" class="section bg-p2" aria-label="Foto y vers√≠culo" data-name="foto-verse">
        <div class="overlay"></div>
        <div class="card" style="text-align:center">
          <img src="foto1.jpg" alt="Abril y Pablo" class="photo-romantic lb-target" data-src="foto1.jpg">
          <p class="verse-big" style="max-width:780px;margin:12px auto 0">
            ‚ÄúAs√≠ que no son ya m√°s dos, sino una sola carne; por tanto, lo que Dios junt√≥, no lo separe el hombre.‚Äù
            ‚Äî <strong>Mateo 19:6</strong>
          </p>
        </div>
      </section>
      <!-- ====================== P√ÅGINA 4 ‚Äî ITINERARIO ====================== -->
      <section id="sec-itinerario" class="section bg-p3" aria-label="Itinerario" data-name="itinerario">
        <div class="overlay"></div>
        <div class="card">
          <h2 class="romantic" style="text-align:center">Itinerario del Gran D√≠a</h2>
          <p class="romantic" style="text-align:center; font-size:20px; margin-top:8px">
            28 de diciembre del 2025
          </p>

          <!-- Contador m√°s peque√±o -->
          <div id="mainCountdown" style="text-align:center; margin:18px auto;">
            <div class="mini-flip" id="flipTimer">
              <div class="flip-mini" data-k="d"><div class="face top">00</div><div class="face bottom">00</div></div>
              <div class="flip-mini" data-k="h"><div class="face top">00</div><div class="face bottom">00</div></div>
              <div class="flip-mini" data-k="m"><div class="face top">00</div><div class="face bottom">00</div></div>
              <div class="flip-mini" data-k="s"><div class="face top">00</div><div class="face bottom">00</div></div>
            </div>
          </div>

          <div style="margin-top:12px; text-align:center; font-family:'Cormorant Garamond',serif; font-size:20px;">
            <strong>Ceremonia Religiosa ‚Äî 2:00 PM</strong><br>
            Iglesia Cristiana Palabra de Vida AD<br>
            Rodeo #35, Gabriel Tepepa, Tlaquiltenango, Morelos<br>
            <a href="https://maps.app.goo.gl/AWYkNZ44jyshjRUG6" target="_blank" class="magicBtn" style="margin-top:10px;">Ver mapa</a>
          </div>

          <div style="margin-top:24px; text-align:center; font-family:'Cormorant Garamond',serif; font-size:20px;">
            <strong>Recepci√≥n ‚Äî 4:00 PM</strong><br>
            Jard√≠n Los Abuelos<br>
            Insurgentes #819, Gabriel Tepepa, Tlaquiltenango, Morelos<br>
            <a href="https://maps.app.goo.gl/B2W65gnaMnyodGh56" target="_blank" class="magicBtn" style="margin-top:10px;">Ver mapa</a>
          </div>

          <hr style="margin:26px 0; border:none; border-top:1px solid #ccc;">

          <h3 class="romantic" style="text-align:center;">C√≥digo de vestimenta</h3>
          <p style="text-align:center;">Formal ‚Äî Tonos recomendados:</p>

          <div style="display:flex; justify-content:center; gap:10px; flex-wrap:wrap; margin-top:12px;">
            <div style="width:38px;height:38px;border-radius:50%;background:var(--chip-celeste);" title="Celeste"></div>
            <div style="width:38px;height:38px;border-radius:50%;background:var(--chip-beige);" title="Beige"></div>
            <div style="width:38px;height:38px;border-radius:50%;background:var(--chip-verde);" title="Verde"></div>
            <div style="width:38px;height:38px;border-radius:50%;background:var(--chip-gris);" title="Gris"></div>
            <div style="width:38px;height:38px;border-radius:50%;background:var(--chip-rosa);" title="Rosa"></div>
          </div>

          <p style="text-align:center; margin-top:16px; font-style:italic;">Dejemos el blanco para la novia ‚ú®</p>

        </div>
      </section>


      <!-- ====================== P√ÅGINA 5 ‚Äî GALER√çA ====================== -->
      <section id="sec-galeria" class="section bg-p4" aria-label="Galer√≠a" data-name="galeria">
        <div class="overlay"></div>
        <div class="card">
          <h2 class="romantic" style="text-align:center">Nuestra Galer√≠a</h2>

          <div class="gallery-grid">
            <img src="momento1.jpg" class="gallery-item" data-index="0">
            <img src="momento2.jpg" class="gallery-item" data-index="1">
            <img src="momento3.jpg" class="gallery-item" data-index="2">
            <img src="momento4.jpg" class="gallery-item" data-index="3">
            <img src="momento5.jpg" class="gallery-item" data-index="4">
            <img src="momento6.jpg" class="gallery-item" data-index="5">
            <img src="momento7.jpg" class="gallery-item" data-index="6">
          </div>
        </div>
      </section>

      <!-- Lightbox galer√≠a -->
      <div id="lightbox" class="lightbox hidden">
        <span class="closeBtn">&times;</span>
        <span class="prevBtn">&#10094;</span>
        <img id="lightboxImg" src="">
        <span class="nextBtn">&#10095;</span>
      </div>


      <!-- ====================== P√ÅGINA 6 ‚Äî RSVP & BUENOS DESEOS ====================== -->
      <section id="sec-rsvp" class="section bg-p5" aria-label="Confirmar asistencia" data-name="rsvp">
        <div class="overlay"></div>
        <div class="card">
          <h2 class="romantic" style="text-align:center">Confirma tu asistencia</h2>

          <div class="btns" style="margin-top:18px;">
            <a href="https://script.google.com/macros/s/AKfycbyDEgVJzj-vGvwxFE1eqTmKb4pO4__lXB9gX8gMKGc2yGhlzR15AFPY8vQMvnjoNs01Vg/exec"
              target="_blank" class="magicBtn">Confirmar asistencia</a>

            <a href="https://script.google.com/macros/s/AKfycbwY2G6aHz1-W9Sk3CUspgJYNf2EhEchr_gNk4mvaZS4wXn7sKIfIV3Qy-Wje2UCKdgC/exec"
              target="_blank" class="magicBtn">Dejar buenos deseos</a>
          </div>

          <p style="text-align:center;margin-top:18px;font-style:italic;color:#444;">
            Tus mensajes se guardar√°n y podr√°n leerse en tiempo real ‚ú®
          </p>
        </div>
      </section>


      <!-- ====================== P√ÅGINA 7 ‚Äî GALER√çA COLABORATIVA ====================== -->
      <section id="sec-colab" class="section bg-p6" aria-label="Galer√≠a colaborativa" data-name="colaborativa">
        <div class="overlay"></div>
        <div class="card" style="text-align:center;">
          <h2 class="romantic">Galer√≠a de los Invitados</h2>
          <p style="margin-top:10px;">
            Comparte tus fotos o videos de nuestro d√≠a especial üíó
          </p>

          <img src="momento9.jpg" alt="Foto especial" style="max-width:420px;width:90%;border-radius:14px;margin:22px auto;box-shadow:0 12px 30px rgba(0,0,0,.15);">

          <a href="https://docs.google.com/forms/d/e/1FAIpQLSfDX9Ky8YrQ962Uxh5ibEYGDk2WsyyVUxUPC09IcwrBKlHx7A/viewform?usp=header"
            target="_blank" class="magicBtn">Subir foto o video</a>
        </div>
      </section>
<script>
/* ======================= UTILIDAD SEGURA DE SELECTORES ======================= */
const $  = (sel, ctx=document) => ctx.querySelector(sel);
const $$ = (sel, ctx=document) => Array.from(ctx.querySelectorAll(sel));

/* ======================= ORDEN DE SECCIONES (flipbook) ======================= */
const order = [
  'sec-portada',
  'sec-familias',
  'sec-foto-verse',
  'sec-itinerario',
  'sec-galeria',
  'sec-rsvp',
  'sec-colab',       // p√°gina 7 (colaborativa)
  'sec-momento8',    // p√°gina 8
  'sec-final'        // p√°gina 9
];

const sections = order.map(id => document.getElementById(id)).filter(Boolean);
let current = 0;
let firstNavDone = false;
let wheelLock = false;

/* ================ FLIPBOOK: ESTADOS / NAVEGACI√ìN / TECLAS / SWIPES ================ */
function setStates(idx){
  sections.forEach((s,i)=>{
    s.classList.remove('active','prev','next');
    if(i<idx) s.classList.add('prev'); else if(i>idx) s.classList.add('next');
  });
  sections[idx]?.classList.add('active');
}
function playFlipSoundBook(){
  try{
    const ctx = window._audioCtx || new (window.AudioContext||window.webkitAudioContext)();
    window._audioCtx = ctx;
    const t = ctx.currentTime;

    const o1 = ctx.createOscillator(), g1 = ctx.createGain();
    o1.type='sawtooth'; o1.frequency.setValueAtTime(180, t);
    o1.frequency.exponentialRampToValueAtTime(120, t+0.08);
    g1.gain.setValueAtTime(0.0001, t);
    g1.gain.exponentialRampToValueAtTime(0.18, t+0.02);
    g1.gain.exponentialRampToValueAtTime(0.0001, t+0.14);
    o1.connect(g1).connect(ctx.destination); o1.start(t); o1.stop(t+0.16);

    const o2 = ctx.createOscillator(), g2 = ctx.createGain();
    o2.type='triangle'; o2.frequency.setValueAtTime(520, t+0.04);
    o2.frequency.exponentialRampToValueAtTime(340, t+0.16);
    g2.gain.setValueAtTime(0.0001, t);
    g2.gain.exponentialRampToValueAtTime(0.20, t+0.06);
    g2.gain.exponentialRampToValueAtTime(0.0001, t+0.22);
    o2.connect(g2).connect(ctx.destination); o2.start(t+0.02); o2.stop(t+0.24);
  }catch(e){}
}
function show(i, playSound=true){
  if (!sections.length) return;
  i = ((i % sections.length) + sections.length) % sections.length;
  if (i !== current && firstNavDone && playSound) playFlipSoundBook();
  setStates(i);
  current = i;

  const hide = (order[i] === 'sec-portada');
  $$('#navArrows button').forEach(b=>{ if(b) b.style.display = hide ? 'none':'block'; });

  markActiveInMenu(order[i]);
  if(order[i] === 'sec-itinerario'){
    $$('#sec-itinerario .it-item').forEach((it, idx)=> setTimeout(()=>it.classList.add('show'), idx*140));
  }
  if (i!==0) firstNavDone = true;
}
show(0,false);

/* Rueda / scroll ‚Äúp√°gina a p√°gina‚Äù */
function onWheel(e){
  if(wheelLock) return;
  wheelLock = true;
  const dy = e.deltaY;
  if(Math.abs(dy) < 10){ wheelLock = false; return; }
  if(dy > 0) show(current+1);
  else show(current-1);
  setTimeout(()=>wheelLock=false, 650);
}
window.addEventListener('wheel', onWheel, {passive:true});

/* Flechas, teclado */
$('#prevBtn')?.addEventListener('click',()=>show(current-1));
$('#nextBtn')?.addEventListener('click',()=>show(current+1));

window.addEventListener('keydown', (e) => {
  if(e.key==='ArrowRight' || e.key==='PageDown') show(current+1);
  if(e.key==='ArrowLeft'  || e.key==='PageUp')   show(current-1);
  if(e.key==='Home') show(0);
  if(e.key==='End')  show(order.length-1);
  if(e.key==='Escape' && $('#lightbox')?.classList.contains('open')) closeLb();
});

/* Swipes (m√≥vil) */
let touchStartX=0, touchStartY=0;
document.addEventListener('touchstart', (e)=>{
  if(e.touches[0]){ touchStartX=e.touches[0].clientX; touchStartY=e.touches[0].clientY; }
},{passive:true});
document.addEventListener('touchend', (e)=>{
  const t = e.changedTouches?.[0]; if(!t) return;
  const dx = t.clientX - touchStartX;
  const dy = t.clientY - touchStartY;
  if(Math.abs(dx) > Math.abs(dy) && Math.abs(dx)>42){
    if(dx<0) show(current+1); else show(current-1);
  }else if(Math.abs(dy)>80){
    if(dy<0) show(current+1); else show(current-1);
  }
},{passive:true});

/* ========================= MEN√ö LATERAL / BOTONES ========================= */
const sideMenu = $('#sideMenu');
const menuToggle = $('#menuToggle');

function markActiveInMenu(id){
  if(!sideMenu) return;
  $$('a[data-goto]', sideMenu).forEach(a=>{
    a.classList.toggle('active', a.getAttribute('data-goto')===id);
  });
}
function closeMenuOnMobile(){ sideMenu?.classList.remove('open'); }

$$('.magicBtn[data-target]').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    const tgt = btn.getAttribute('data-target');
    const i   = order.indexOf(tgt);
    if(i>=0){ show(i); closeMenuOnMobile(); }
  });
});

if (sideMenu){
  $$('a[data-goto]', sideMenu).forEach(a=>{
    a.addEventListener('click', (e)=>{
      e.preventDefault();
      const id  = a.getAttribute('data-goto');
      const idx = order.indexOf(id);
      if(idx>=0){ show(idx); closeMenuOnMobile(); }
    });
  });
}
menuToggle?.addEventListener('click', ()=> sideMenu?.classList.toggle('open'));

/* Resalta la secci√≥n visible si el usuario deja el men√∫ abierto */
setInterval(()=> markActiveInMenu(order[current]), 1200);

/* ========================= AUDIO: ENTRADA + CROSSFADE ========================= */
const marcha        = $('#marcha');
const eternamente   = $('#eternamente');
const musicRetryBtn = $('#musicRetry');
const entryOverlay  = $('#entryOverlay');
const entryRing     = $('#entryRing');
const portadaRing   = $('#ringBtn');

function playUnlocked(audio){
  if(!audio) return Promise.resolve(false);
  try{
    const p = audio.play();
    if(p && typeof p.then==='function'){ return p.then(()=>true).catch(()=>false); }
    return Promise.resolve(true);
  }catch(_){ return Promise.resolve(false); }
}
async function startMarcha(){
  if(!marcha) return;
  try{
    marcha.currentTime = 0;
    marcha.volume = 1; // sin fade-in por indicaci√≥n
    const ok = await playUnlocked(marcha);
    if(!ok) musicRetryBtn?.setAttribute('aria-hidden','false');
  }catch(_){
    musicRetryBtn?.setAttribute('aria-hidden','false');
  }
}
function fadeAudio(audio, from, to, duration=2000){
  return new Promise(res=>{
    if(!audio){ res(); return; }
    const steps=40, dt=duration/steps;
    let i=0;
    audio.volume = Math.max(0, Math.min(1, from));
    const id=setInterval(()=>{
      i++;
      audio.volume = Math.max(0, Math.min(1, from + (to-from)*(i/steps)));
      if(i>=steps){ clearInterval(id); audio.volume = Math.max(0, Math.min(1, to)); res(); }
    }, dt);
  });
}

/* Entrada: ‚ÄúToca para comenzar‚Äù (desbloquea audio) */
entryRing?.addEventListener('click', async ()=>{
  await startMarcha();
  entryOverlay?.classList.add('hide');
});

/* Fallback si el navegador bloquea */
musicRetryBtn?.addEventListener('click', async ()=>{
  const ok = await playUnlocked(marcha);
  if(ok) musicRetryBtn.setAttribute('aria-hidden','true');
});

/* Anillo de la portada: crossfade a ‚Äòeternamente‚Äô y pasar a Familias */
portadaRing?.addEventListener('click', async ()=>{
  try{
    if(marcha && !marcha.paused){ await fadeAudio(marcha, marcha.volume||1, 0, 2000); marcha.pause(); }
  }catch(e){}
  try{
    if(eternamente){
      eternamente.currentTime = 0;
      eternamente.volume      = 0;
      const ok = await playUnlocked(eternamente);
      if(ok){ await fadeAudio(eternamente, 0, 1, 2000); }
      else { musicRetryBtn?.setAttribute('aria-hidden','true'); }
    }
  }catch(e){}
  const idx = order.indexOf('sec-familias');
  if(idx>=0) show(idx);
  portadaRing.classList.add('clicked');
  setTimeout(()=>portadaRing.classList.remove('clicked'), 900);
});

/* ========================= CONTADORES (PORTADA MINI + P4 MINI) ========================= */
const target = new Date('2025-12-28T14:00:00'); // 28 dic 2025 2:00 p.m.
const pad    = n=>String(n).padStart(2,'0');

function updateMini(containerSel){
  const flips = $$(containerSel + ' .flip-mini');
  const now   = new Date(); let diff = Math.max(0, target - now);
  const d=Math.floor(diff/86400000); diff-=d*86400000;
  const h=Math.floor(diff/3600000);  diff-=h*3600000;
  const m=Math.floor(diff/60000);    diff-=m*60000;
  const s=Math.floor(diff/1000);
  const vals = [String(d), pad(h), pad(m), pad(s)];
  flips.forEach((f,i)=>{
    const top = $('.top', f), bot = $('.bottom', f);
    if(!top || !bot) return;
    if(top.textContent===vals[i]) return;
    bot.textContent = vals[i];
    f.classList.remove('animate'); void f.offsetWidth; f.classList.add('animate');
    setTimeout(()=>{ top.textContent = vals[i]; f.classList.remove('animate'); }, 700);
  });
}
setInterval(()=>{
  if($('#miniFlip')) updateMini('#miniFlip');     // portada
  if($('#flipTimer')) updateMini('#flipTimer');   // p√°gina 4 reducido
}, 1000);

/* ========================= LIGHTBOX (Galer√≠a) ========================= */
const lb     = $('#lightbox'); // existe s√≥lo en P5
const lbImg  = $('#lightboxImg');
const lbPrev = $('.prevBtn', lb);
const lbNext = $('.nextBtn', lb);
const lbCloseBtn = $('.closeBtn', lb);

const galleryItems = $$('.gallery-item');
const lbTargets    = [...$$('.lb-target'), ...galleryItems];
const lbSrcs       = lbTargets.map(t=>t.dataset.src || t.getAttribute('src'));
let lbIndex        = 0;

function openLb(i){
  if(!lb || !lbImg) return;
  lbIndex = i;
  lbImg.style.opacity=0;
  lbImg.src = lbSrcs[lbIndex];
  lb.classList.remove('hidden');
  lb.classList.add('open');
  lb.setAttribute('aria-hidden','false');
  setTimeout(()=>{ lbImg.style.transition='opacity .45s ease, transform .45s ease'; lbImg.style.opacity=1; lbImg.style.transform='scale(1)'; }, 40);
}
function closeLb(){
  if(!lb || !lbImg) return;
  lb.classList.remove('open');
  lb.classList.add('hidden');
  lbImg.src='';
  lb.setAttribute('aria-hidden','true');
}
function lbShow(dir){
  if(!lbImg) return;
  lbIndex = (lbIndex + (dir>0?1:-1) + lbSrcs.length) % lbSrcs.length;
  lbImg.style.opacity=0;
  setTimeout(()=>{ lbImg.src = lbSrcs[lbIndex]; lbImg.style.opacity=1; }, 260);
}

lbTargets.forEach((t,i)=> t.addEventListener('click', ()=> openLb(i) ));
lbPrev   ?.addEventListener('click', ()=> lbShow(-1));
lbNext   ?.addEventListener('click', ()=> lbShow(1));
lbCloseBtn?.addEventListener('click', closeLb);
lb?.addEventListener('click', (e)=>{ if(e.target===lb) closeLb(); });

/* ========================= MEN√ö PORTADA: ENLACES DIRECTOS ========================= */
/* Asegura que los botones de portada vayan a las secciones correctas */
$$('.btns .magicBtn').forEach(b=>{
  const t = b.textContent.trim().toLowerCase();
  if(t.includes('famil')) b.setAttribute('data-target','sec-familias');
  if(t.includes('itinerario')) b.setAttribute('data-target','sec-itinerario');
  if(t.includes('galer')) b.setAttribute('data-target','sec-galeria');
  if(t.includes('confirmar') || t.includes('asistencia')) b.setAttribute('data-target','sec-rsvp');
});

/* ========================= GOOGLE CALENDAR ========================= */
$('#addCalendar')?.addEventListener('click', (e)=>{
  e.preventDefault();
  const start='20251228T140000';
  const end  ='20251228T230000';
  const title   = encodeURIComponent('Boda ‚Äî Abril & Pablo');
  const details = encodeURIComponent('Ceremonia y recepci√≥n ‚Äî Abril & Pablo');
  const location= encodeURIComponent('Iglesia Cristiana Palabra de Vida AD / Jard√≠n Los Abuelos, Tlaquiltenango, Morelos');
  const url = `https://www.google.com/calendar/render?action=TEMPLATE&text=${title}&dates=${start}/${end}&details=${details}&location=${location}`;
  window.open(url,'_blank','noopener');
});

/* ========================= CURSOR M√ÅGICO (corazones) ========================= */
function createHeartAt(x,y){
  const heart=document.createElement('div');
  heart.className='magicHeart';
  const size=16 + Math.random()*14;
  heart.style.width = size+'px';
  heart.style.height= size+'px';
  const jitter=18;
  heart.style.left=(x + (Math.random()*jitter - jitter/2))+'px';
  heart.style.top =(y + (Math.random()*jitter - jitter/2))+'px';
  const r=Math.random();
  if(r<0.25)      heart.style.background='radial-gradient(circle,#ffffff,#f0f0f0)';
  else if(r<0.5)  heart.style.background='radial-gradient(circle,#4dc3ff,#bfeeff)';
  else if(r<0.75) heart.style.background='radial-gradient(circle,#c8c8c8,#ffffff)';
  else            heart.style.background='radial-gradient(circle,#a7ffcf,#eafff0)';
  heart.style.clipPath='polygon(50% 0%,61% 15%,75% 15%,84% 27%,84% 45%,75% 60%,50% 80%,25% 60%,16% 45%,16% 27%,25% 15%,39% 15%)';
  document.body.appendChild(heart);
  const life=1500 + Math.random()*400;
  setTimeout(()=>heart.remove(), life);
}
function spawnHearts(x,y,countMin=3,countMax=4){
  const n = Math.floor(countMin + Math.random()*(countMax-countMin+1));
  for(let i=0;i<n;i++){ setTimeout(()=>createHeartAt(x,y), i*60); }
}
document.addEventListener('mousemove',(e)=>{ if(Math.random()>0.6) return; spawnHearts(e.clientX,e.clientY,3,4); });
document.addEventListener('click',(e)=>{ spawnHearts(e.clientX,e.clientY,3,4); });
document.addEventListener('touchstart',(e)=>{ const t=e.touches?.[0]; if(!t) return; spawnHearts(t.clientX,t.clientY,3,4); },{passive:true});
document.addEventListener('touchmove',(e)=>{ const t=e.touches?.[0]; if(!t) return; if(Math.random()>0.6) return; spawnHearts(t.clientX,t.clientY,3,4); },{passive:true});

/* ========================= ARRANQUE ========================= */
window.addEventListener('load', ()=>{
  // Si abriste en medio (recarga), animar items del itinerario al entrar
  if(order[current]==='sec-itinerario'){
    $$('#sec-itinerario .it-item').forEach((it, idx)=> setTimeout(()=>it.classList.add('show'), idx*140));
  }
});
</script>

     
